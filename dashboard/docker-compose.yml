version: "3.9"
services:
  base: &base
     build: .
     secrets:
       - app_secrets
  shell:
    <<: *base
    container_name: dapp
    ports:
      - "8501:8501"
    command: >
      bash -c "source /run/secrets/app_secrets && bash"
  dapp:
    <<: *base
    ports:
      - "8501:8501"
    command: >
      bash -c "source /run/secrets/app_secrets && streamlit hello"

  jupyter:
    <<: *base
    container_name: jupyter
    ports:
      - "8888:8888"

    volumes:
      - ./notebooks:/app/notebooks:delegated



    command: >
      bash -c "source /run/secrets/app_secrets && jupyter notebook --allow-root --port=8888 --no-browser --ip=0.0.0.0"
secrets:
  app_secrets:
    file: ./secrets.sh



